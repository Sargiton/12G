#!/bin/bash

echo "üîß –ü–û–õ–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö –ë–û–¢–ê"

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞
echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞..."
pm2 stop whatsapp-old 2>/dev/null || true

# –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–ø–∫–∏
echo "üìÅ –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–ø–∫–∏..."
mkdir -p tmp
mkdir -p logs
mkdir -p storage/img
mkdir -p storage/data

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
echo "üîê –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞..."
chmod 755 tmp
chmod 755 logs
chmod 755 storage
chmod 755 storage/img
chmod 755 storage/data

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
echo "üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª—ã..."
touch storage/data/database.json
echo "{}" > storage/data/database.json

# –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
echo "üßπ –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã..."
rm -f tmp/*.jpg
rm -f tmp/*.png
rm -f tmp/*.mp4
rm -f tmp/*.webp

# –°–æ–∑–¥–∞–µ–º .gitkeep —Ñ–∞–π–ª—ã
echo "üìù –°–æ–∑–¥–∞–µ–º .gitkeep —Ñ–∞–π–ª—ã..."
touch tmp/.gitkeep
touch logs/.gitkeep

# –ö–æ–ø–∏—Ä—É–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
echo "üìã –ö–æ–ø–∏—Ä—É–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã..."
cp plugins/main-menu18.js 123/plugins/main-menu18.js
cp plugins/main-menu1.js 123/plugins/main-menu1.js

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏..."
cd 123
npm install node-telegram-bot-api --save
cd ..

# –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
echo "ü§ñ –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞..."
pm2 start ecosystem-old.config.cjs

echo "‚è≥ –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞..."
sleep 5

echo "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã!"
echo "üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ –ø–∞–ø–∫–∏:"
echo "‚Ä¢ tmp/ - –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤"
echo "‚Ä¢ logs/ - –¥–ª—è –ª–æ–≥–æ–≤"
echo "‚Ä¢ storage/img/ - –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
echo "‚Ä¢ storage/data/ - –¥–ª—è –¥–∞–Ω–Ω—ã—Ö"

echo ""
echo "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:"
echo "‚Ä¢ main-menu18.js - —É–±—Ä–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
echo "‚Ä¢ main-menu1.js - —É–±—Ä–∞–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"

echo ""
echo "üìä –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞:"
pm2 list | grep whatsapp-old || echo "–ë–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω"

echo ""
echo "üéØ –¢–µ–ø–µ—Ä—å –∫–æ–º–∞–Ω–¥–∞ '–º–µ–Ω—é' –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫!"
echo "üìã –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–æ–≤: pm2 logs whatsapp-old"
